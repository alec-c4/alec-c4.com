<section class="mx-auto mt-12">
  <div id="giscus-container">
    <script
      is:inline
      src="https://giscus.app/client.js"
      data-repo="alec-c4/alec-c4.com"
      data-repo-id="R_kgDOJj7Xew"
      data-category="General"
      data-category-id="DIC_kwDOJj7Xe84CmTPj"
      data-mapping="pathname"
      data-strict="0"
      data-reactions-enabled="1"
      data-emit-metadata="0"
      data-input-position="bottom"
      data-theme="noborder_light"
      data-lang="en"
      crossorigin="anonymous"
      async></script>
  </div>
</section>
<script is:inline>
  function updateGiscusTheme() {
    const theme =
      document.documentElement.getAttribute("data-theme") === "dark"
        ? "dark_dimmed"
        : "light";

    const iframe = document.querySelector("iframe.giscus-frame");
    if (iframe) {
      iframe.contentWindow.postMessage(
        { giscus: { setConfig: { theme } } },
        "https://giscus.app"
      );
    } else {
      const giscusContainer = document.getElementById("giscus-container");
      if (giscusContainer) {
        const giscusScript = giscusContainer.querySelector("script");
        if (giscusScript) {
          giscusScript.setAttribute(
            "data-theme",
            theme === "dark" ? "noborder_dark" : "noborder_light"
          );
        }
      }
    }
  }

  updateGiscusTheme();

  const observer = new MutationObserver(updateGiscusTheme);
  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ["data-theme"],
  });

  window.addEventListener("load", updateGiscusTheme);

  const bodyObserver = new MutationObserver(() => {
    if (document.querySelector("iframe.giscus-frame")) {
      updateGiscusTheme();
    }
  });

  bodyObserver.observe(document.body, {
    childList: true,
    subtree: true,
  });
</script>
